# Nordic Gradle Plugins for Android

The repo contains plugins which are shared between Nordic's Android applications.
[Now in Android app](https://github.com/android/nowinandroid) from Google has been an inspiration
for writing Nordic's dedicated plugins.

## Plugins

![Gradle Plugin Portal Version](https://img.shields.io/gradle-plugin-portal/v/no.nordicsemi.android.plugin.application)

List of plugins currently available in the repository.

### Android plugins

1. [no.nordicsemi.android.plugin.application](plugins/src/main/kotlin/AndroidApplicationConventionPlugin.kt)

   This plugin does the following:
   * applies `com.android.application`,
   * defines `compileSdk`, `minSdk` and `targetSdk` to values set in
     [`AppConsts`](https://github.com/NordicSemiconductor/Android-Gradle-Plugins/blob/kotlin2/plugins/src/main/kotlin/no/nordicsemi/android/AppConsts.kt),
   * sets `buildConfig`,
   * configures _debug_ and _release_ build types,
   * creates app signing configuration using `../keystore` file which is generated by GitHub actions during build.

2. [no.nordicsemi.android.plugin.application.compose](plugins/src/main/kotlin/AndroidApplicationComposeConventionPlugin.kt)

   This plugin applies `no.nordicsemi.android.plugin.application` and adds Compose and Material3 dependency.

   Since version 2.1 [`enableStrongSkippingMode`](https://www.jetbrains.com/help/kotlin-multiplatform-dev/compose-compiler.html#enablestrongskippingmode) is
   [enabled](https://github.com/NordicSemiconductor/Android-Gradle-Plugins/blob/6ee70d9f2fb2c2c8474067845eac05308740afa8/plugins/src/main/kotlin/no/nordicsemi/android/buildlogic/AndroidCompose.kt#L66).

3. [no.nordicsemi.android.plugin.library](plugins/src/main/kotlin/AndroidLibraryConventionPlugin.kt)

   This plugin does the following:
   * applies `com.android.library`,
   * defines `compileSdk` and `minSdk` to values set in
     [`AppConsts`](https://github.com/NordicSemiconductor/Android-Gradle-Plugins/blob/kotlin2/plugins/src/main/kotlin/no/nordicsemi/android/AppConsts.kt),
   * sets `buildConfig`,
   * configures _debug_ and _release_ build types.

4. [no.nordicsemi.android.plugin.library.compose](plugins/src/main/kotlin/AndroidLibraryComposeConventionPlugin.kt)

   This plugin applies `no.nordicsemi.android.plugin.library` and adds Compose and Material3 dependency.

   Since version 2.1 [`enableStrongSkippingMode`](https://www.jetbrains.com/help/kotlin-multiplatform-dev/compose-compiler.html#enablestrongskippingmode) is
   [enabled](https://github.com/NordicSemiconductor/Android-Gradle-Plugins/blob/6ee70d9f2fb2c2c8474067845eac05308740afa8/plugins/src/main/kotlin/no/nordicsemi/android/buildlogic/AndroidCompose.kt#L66).

5. [no.nordicsemi.android.plugin.kotlin](plugins/src/main/kotlin/AndroidNexusRepositoryPlugin.kt)

   This plugin applies `org.jetbrains.kotlin.android` and configures Kotlin compiler.

7. [no.nordicsemi.android.plugin.hilt](plugins/src/main/kotlin/AndroidHiltConventionPlugin.kt)

   This plugin applies `no.nordicsemi.android.plugin.kotlin` and `com.google.devtools.ksp` and
   configures [Hilt](https://dagger.dev/hilt/) for the module.

9. [no.nordicsemi.android.plugin.feature](plugins/src/main/kotlin/AndroidFeatureConventionPlugin.kt)

   This plugin applies:
   * `no.nordicsemi.android.plugin.library.compose`
   * `no.nordicsemi.android.plugin.hilt`
   * `no.nordicsemi.android.plugin.kotlin`

   and adds dependency to `androidx.hilt.navigation.compose`.

10. [no.nordicsemi.android.plugin.nexus](plugins/src/main/kotlin/AndroidKotlinConventionPlugin.kt)

Creates `publish` and `releaseStagingRepositories` tasks using `maven-publish`.

### JVM plugins

1. [no.nordicsemi.jvm.plugin.kotlin](plugins/src/main/kotlin/JvmKotlinConventionPlugin.kt) (since 2.1)

   This plugin applies `org.jetbrains.kotlin.jvm` and configures Kotlin compiler.

2. [no.nordicsemi.jvm.plugin.nexus](plugins/src/main/kotlin/JvmNexusRepositoryPlugin.kt) (since 2.0)

   Creates `publish` and `releaseStagingRepositories` tasks using `maven-publish`.

Plugins are released to [Gradle Plugins](https://plugins.gradle.org/search?term=no.nordicsemi) repository
and are available by their ids and version number.

> [!Note]
> Version 2.1 altered ids of the plugins by replacing `gradle` with `plugin`.

## Version catalog

![Maven Central Version](https://img.shields.io/maven-central/v/no.nordicsemi.android.gradle/version-catalog)

The repository also contains Gradle Version Catalog with [toml](gradle/libs.versions.toml) file.
The file is automatically used by gradle to create libs reference in _build.gradle.kts_ files.

### Set up

Include the following code in your _settings.gradle.kts_ file:
```kotlin
pluginManagement {
    repositories {
        mavenLocal()
        google()
        mavenCentral()
        gradlePluginPortal()
    }
}

dependencyResolutionManagement {
    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
    repositories {
        mavenLocal()
        google()
        mavenCentral()
    }
    versionCatalogs {
        create("libs") {
            from("no.nordicsemi.android.gradle:version-catalog:<version>")
        }
    }
}
```

Dependencies can be later set using `libs` reference in _build.gradle.kts_ files:
```kotlin
plugins {
    alias(libs.plugins.android.application) apply false
}

dependencies {
    // Example dependency:
    implementation(libs.nordic.dfu)
    implementation(libs.androidx.compose.material.iconsExtended)
}
```
